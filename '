#include "minirt.h"



static void fillObject(t_object **object, char **arr, int len)
{
	object->type = findType(*arr);
	object->color = finColor(arr, len);
}

//
static t_object	parseLine(char *line)
{
	t_object	*new;
	char		*src;
	char		*ptr;

	new = createObjectNode();
	if (!new)
		return (NULL);
	src = line;	
/*
	int			len;
	char		**split;
	
	len = 0;
	split = splitLine(line, WHITESPACES, &len);
	if (!split)
		return (freeObject(new));
	fillObject(&new, split, len);/
	return (freeArr(split, len), new);
*/
	return (free(line), line = NULL, new);
}

//
t_minirt	*readFileContentAndCreateScene(t_scene *scene, int fd)
{
	t_object	*new;
	t_object	*head;
	t_object	*tail;
	t_minirt	*scene;
	char		*element;

	head = NULL;
	tail = NULL;
	scene = createMinirtNode();
	if (!scene)
		return (NULL);
	element = get_next_line(fd);
	while (element)
	{
		new = parseLine(element);
		if (!new)
			return (close(fd), freeMinirt(scene), scene);	
		insertNewObject(&head, &tail, new);
		free(element);
		element = get_next_line(fd);
	}
	return (close(fd), scene);
}

